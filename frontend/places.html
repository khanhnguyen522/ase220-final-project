<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link rel="stylesheet" href="/places.css">
    <link rel="stylesheet" href="/cities.css">
    <title>Popular Destinations</title>
  </head>
  <body>
    <div class="makeItFixed">
      <nav class="navbar nav-pills justify-content-around bg-light ">
        <a class=" navbar-brand fs-2 fw-semibold " href="#">Popular Destinations<span id="country_name"></span></a>
        <form class="d-flex " style = "width: 400px;" role="search">
          <select class="form-control me-1 " id="places">
            <option value="">Select A Destination</option>
          </select>     
          <button class="btn btn-outline-dark" type="submit" id = "search-place">
              <i class="bi bi-search"></i> 
          </button>
        </form>
        <div class="auth-container d-flex gap-4 align-items-center w-20"></div>
      </nav> 
  </div> 
    <div class="d-flex justify-content-center">
      <div class="container text-cente m-5">
        <div class = "container text-end m-3"> 
          <div class="mt-4">
            <div class="row">
              <div class="col">
                <a data-bs-toggle="modal" data-bs-target="#add_modal" class="btn btn-dark" id="btn-add">
                  <i class="bi bi-plus-circle"></i>
                </a>
              </div>
            </div>
            <div class="row mt-2">
            </div>
          </div> 
        <div
          id="destinations-container"
          class="row row-cols-1 row-cols-sm-2 row-cols-lg-3"
        ></div>

        <!-- PAGINATION -------------------------------------------------------------------->
        <div id="actions" class="d-flex justify-content-center my-4"></div>
      </div>
          <!--Contacts-->
          <section class = "contacts" style = "height: 50px;position:relative;bottom: 20; width: 100%;justify-content: center; align-items: center;">
            <ul class= "ul">
              <li class ="li">
                <a class = "a" href="#">
                  <i class="fab fa-facebook-f icon"></i> </a>
              </li>
              <li class = "li">
                <a  class = "a" href="#">
                  <i class="fab fa-twitter icon"></i></a>
              </li>
              <li class = "li" >
                <a class = "a" href="#"><i class="fab fa-linkedin-in icon"></i></a></li>
              <li class = "li">
                <a class = "a" href="#"><i class="fab fa-google-plus-g icon"></i></a></li>
            </ul>
          </section>

      <!-- Login --------------------------------------------------------------->
      <div class="modal fade" id="login_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true" >
        <div class="modal-dialog modal-dialog-centered" style = "max-width: 400px;">
          <div class="modal-content">
            <div class="modal-header">
              <h2 class="modal-title fs-5 " id="staticBackdropLabel" style = "position: relative; left: 45%;">
                <b>Login</b>
              </h2>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form class="row g-3">
                <div class="col-12">
                  <input type="email" class="form-control" id="loginEmail" required placeholder="Email">
                </div>
                <div class="col-12 ">
                  <input type="password" class="form-control" id="loginPassword" required placeholder="Password">
                </div>
                <div class="col-12 text-center">
                  <button class="btn btn-secondary login-submit-btn" type="submit" >Submit</button>
                  <p>Don't have an account yet?</p>
                  <button type="button" class="btn btn-secondary signup-btn" id="signup-btn" data-bs-dismiss="modal"> Sign up</button>
                </div>
                <div class="loginError"></div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-dark" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
    </div>


 <!-- Signup--------------------------------------------------------------->
 <div class="modal fade" id="signup_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true" >
  <div class="modal-dialog modal-dialog-centered" style = "max-width: 400px;">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title fs-5 " id="staticBackdropLabel" style = "position: relative; left: 45%;">
          <b>Signup</b>
        </h2>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form class="row g-3">
          <div class="col-12">
            <input type="email" class="form-control" id="userName" required placeholder="Username">
          </div>
          <div class="col-12">
            <input type="email" class="form-control" id="siginEmail" required placeholder="Email">
          </div>
          <div class="col-12 ">
            <input type="password" class="form-control" id="siginPassword" required placeholder="Password">
          </div>
          <div class="col-12 text-center">
            <button class="btn btn-secondary login-submit-btn" type="submit" >Submit</button>
            <p>Already have an account?</p>
            <button type="button" class="btn btn-secondary login-btn" id="login-btn" data-bs-dismiss="modal">Login</button>
          </div>
          <div class="loginError"></div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-dark" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

      <!--UPDATE MODAL ------------------------------------------------------->
      <div
        class="modal fade"
        id="update_modal"
        data-bs-backdrop="static"
        data-bs-keyboard="false"
        tabindex="-1"
        aria-labelledby="staticBackdropLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="staticBackdropLabel">
                Update City
              </h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div class="card-body d-flex flex-column">
                <form>
                  <div class="mb-3">
                    <label for="inputName" class="form-label d-flex">Name</label>
                    <input type="text" class="form-control" id="inputName"/>
                  </div>
                  <div class="mb-3">
                    <label for="inputDestination" class="form-label d-flex">Tourist Destinations</label>
                    <input type="text" class="form-control" id="inputDestination" />
                  </div>
                  <div class="mb-3">
                    <label for="inputVisit" class="form-label d-flex">Best Time to Visit</label>
                    <input type="text" class="form-control" id="inputVisit" />
                  </div>
                  <div class="mb-3">
                    <label for="inputRating" class="form-label d-flex">Ratings</label>
                    <input type="text" class="form-control" id="inputRating" />
                  </div>
                  <div class="mb-3 d-flex gap-2">
                    <label for="inputTemperature" class="col-form-label d-flex">Average Temperature:</label>
                    <div class="d-flex align-items-center gap-4">
                      <div class="form-check gap-2">
                        <input
                          type="text"
                          class="form-control"
                          id="HighTemperatureAdd"
                          text = "High Temperature"
                        />
                        <label for="High" class="form-control">High Temperature</label>
                      </div>
                      <div class="form-check gap-2">
                        <input
                          type="text"
                          class="form-control"
                          id="LowTemperatureAdd"
                          text="Low Temperature"
                        />
                        <label for="Low" class="form-control"
                          >Low Temperature</label
                        >
                      </div>
                    </div>
                  </div>
                  <div class="mb-3">
                    <label for="inputDescription" class="form-label d-flex"
                      >Description</label
                    >
                    <textarea
                      class="form-control"
                      id="inputDescription"
                      rows="3"
                    ></textarea>
                  </div>
                </form>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" id="edit-submit" class="btn bg-black text-white">
                Save changes
              </button>
            </div>
          </div>
        </div>
      </div>
      <!--Add Modal-->
      <div
      class="modal fade"
      id="add_modal"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="staticBackdropLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">
              Add Your Favorite Places besides this listed-places
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="card-body d-flex flex-column">
                <form>
                     <div class="mb-3">
                        <label for="cityImageAdd" class="form-label d-flex">Place Image URL</label>
                        <input type="text" class="form-control" id="cityImageAdd" />
                    </div>
                    <div class="mb-3">
                      <label for="inputName" class="form-label d-flex">Name</label>
                      <input type="text" class="form-control" id="inputNameAdd"/>
                    </div>
  
                    <div class="mb-3">
                      <label for="inputDestination" class="form-label d-flex">Tourist Destinations</label>
                      <input type="text" class="form-control" id="inputDestinationAdd" />
                    </div>
  
                    <div class="mb-3">
                      <label for="inputVisit" class="form-label d-flex">Best Time to Visit</label>
                      <input type="text" class="form-control" id="inputVisitAdd" />
                    </div>
  
                    <div class="mb-3">
                      <label for="inputRating" class="form-label d-flex">Ratings</label>
                      <input type="text" class="form-control" id="inputRatingAdd" />
                    </div>
  
                    <div class="mb-3 d-flex gap-2">
                      <label for="inputTemperature" class="col-form-label d-flex">Average Temperature:</label>
                      <div class="d-flex align-items-center gap-4">
                        <div class="form-check gap-2">
                          <input
                            type="text"
                            class="form-control"
                            id="HighAdd"
                            text = "High Temperature"
                          />
                          <label for="HighAdd" class="form-control">High Temperature</label>
                        </div>
                        <div class="form-check gap-2">
                          <input
                            type="text"
                            class="form-control"
                            id="LowAdd"
                            text="Low Temperature"
                          />
                          <label for="LowAdd" class="form-control"
                            >Low Temperature</label
                          >
                        </div>
                      </div>
                    </div>
                    <div class="mb-3">
                      <label for="inputDescriptionAdd" class="form-label d-flex"
                        >Description</label
                      >
                      <textarea
                        class="form-control"
                        id="inputDescriptionAdd"
                        rows="3"
                      ></textarea>
                    </div>
                  </form>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" id="add-submit" class="btn bg-black text-white">
              Add Place
            </button>
          </div>
        </div>
      </div>
    </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <script src="https://kit.fontawesome.com/118e30abce.js" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </script>
    <script>
      let countries = [];
      let cities = []
      let country = "";
      let city = "";
      let places = []
      var offset = 0;
      var rpp = 9;
      var pages = 0;
      var editingCityId = -1;
      var addingCityId = -1;
      var imageFile = "";
      var particularCity = "";
      var details = [];
      let users = []

      const path = window.location.pathname; 
      const pathParts = path.split('/')
      const cityId = pathParts[2]
    
       axios
        .get('http://localhost:8000/v1/user/all', {})
        .then(function (res) {
          users = res.data;
          console.log(users)
        })
        .catch(function (err) {
          console.log(err);
        });

        axios
          .get(`http://localhost:8000/v1/cities/${cityId}/places`, {})
          .then(function(res){
              places = res.data
              console.log(places)
              displayCards(places);
              displayPageBasedPagination(places);
            }).catch(function(err){
              console.log(err)
            })

          function displayPageBasedPagination(details) {
            rpp = 9;
            pages = Math.ceil(details.length / rpp);
            document.querySelector("#actions").innerHTML = "";
            for (let i = 0; i < pages; i++) {
              let loadMoreButton = document.createElement("button");
              loadMoreButton.setAttribute("data-page", i + 1);
              loadMoreButton.classList.add("btn");
              loadMoreButton.classList.add("page-btn");
              if (i * rpp === offset) {
                loadMoreButton.classList.add("btn-secondary");
                loadMoreButton.classList.add("disabled");
              } else {
                loadMoreButton.classList.add("btn-outline-secondary");
              }
              loadMoreButton.classList.add("m-1");
              loadMoreButton.innerText = i + 1;
              loadMoreButton.addEventListener("click", function (e) {
                let buttons = document.querySelectorAll(".page-btn");
                for (let i = 0; i < buttons.length; i++) {
                  buttons[i].classList.remove("disabled");
                  buttons[i].classList.remove("btn-secondary");
                  buttons[i].classList.add("btn-outline-secondary");
                }
                offset = i * rpp;
                e.target.classList.remove("btn-outline-secondary");
                e.target.classList.add("btn-secondary");
                e.target.classList.add("disabled");
                document.getElementById("destinations-container").innerHTML = "";
                displayCards(details);
              });
              document.querySelector("#actions").append(loadMoreButton);
            }
          }
          
          function generateCard(place) {
             const cardHTML = `
              <div class="cols-4 cards my-2" id = ${place._id}>
                  <span class="card h-100 ">
                    <div class="position-relative">
                        <div id="carouselExample${place._id}" class="carousel slide">
                           <div class="carousel-inner rounded-top">
                              <div class="carousel-item active">
                                  <img src="${place.avatar[0]}" class="d-block w-100" alt="image of ${place.place}">
                                </div>

                              <div class="carousel-item">
                                 <img src="${place.avatar[1]}" class="d-block w-100" alt="image of ${place.place}">
                                </div>
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample${place._id}" data-bs-slide="prev">
                              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                              <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselExample${place._id}" data-bs-slide="next">
                              <span class="carousel-control-next-icon" aria-hidden="true"></span>
                              <span class="visually-hidden">Next</span>
                            </button>
                        </div>                                                   
                    </div>

                    <div class="card-body d-flex flex-column" style="text-align: left;">
                      <div class="d-flex justify-content-between">
                      <div class="d-flex"> <h5  class="card-title" style="font-size: 24px;">${place.place}</h5>
                    </div>
                    <div class ="d-flex ">
                      <i class="fa-solid fa-star " ></i> <span style="margin-left: 5px;">${place.ratings}</span>
                      </div>
                      </div>                  
                      <p class="card-text">${place.description}<br>
                        </p>
                    </div>
                    <div class="d-flex flex-column justify-content-end gap-2 m-3">
                      <div id="mylink" class='d-flex justify-content-center gap-2 m-3'>
                        <a>
                          <button class="learn-more">
                            <a  href="/places/${place._id}/comments" class="circle" aria-hidden="true">
                              <span class="icon arrow"></span>
                            </a>
                            <a class="button-text" href="/places/${place._id}/comments">See Comments</a>
                          </button>
                        </a>
                        <a data-bs-toggle="modal" data-bs-target="#update_modal" class="btn btn-dark btn-edit d-flex align-items-center" id="btn-edit">
                          <i class="bi bi-pencil-square"></i>
                        </a>
                        <a class="btn btn-dark btn-delete d-flex align-items-center" id='btn-delete'>
                          <i class="bi bi-trash3-fill"></i>
                        </a>
                      </div>
                    </div>
                  </span>
              </div>`;
            return cardHTML;
          }

          function displayCards(details) {
            for (let i = offset; i < Math.min(offset + rpp, details.length); i++) {
              document.getElementById("destinations-container").innerHTML += generateCard(
                details[i]
              );
            }
          }
//Populate the update model when update button is clicked handled later.
          function populateUpdateModal(place) {
            document.getElementById("inputName").value = place.name;
            document.getElementById("inputDestination").value = place.destinations;
            document.getElementById("inputVisit").value = place.best_time_to_visit;
            document.getElementById("inputRating").value = place.ratings;
            document.getElementById("HighTemperatureAdd").value = place.high;
            document.getElementById("LowTemperatureAdd").value = place.low;
            document.getElementById("inputDescription").value = place.description;
          }
          function getCitiesById(id) {
            return cities.find((City) => City.cityId === id);//return the pet whose id is passed as parameter
          }

        function checkUserInLocalStorage(){
            const user = localStorage.getItem('user')
            const authContainer = $('.auth-container')
            if(user){
              $('#btn-edit').show()
              $('.btn-delete').show()
              $('.btn-add').show()
              const username = JSON.parse(user).name;
              authContainer.html(`
                <div>Hi, ${username}</div>
                <button class = "btn btn-dark"id="logoutBtn">Logout</button>
              `)
            }else{
              $('#btn-add').hide()
              $('.btn-edit').hide()
              $('.btn-delete').hide()
              authContainer.html(`
                <button class ="btn btn-dark" data-bs-toggle="modal" data-bs-target="#login_modal" id="loginBtn">Login</button>
                <button class = "btn btn-dark" data-bs-toggle="modal" data-bs-target="#signup_modal" id="signupBtn">Sign Up</button>
              `)
            }
        }
          
 
          function loginUser(email, password) {
            const foundUser = users.find(
            (user) => user.email === email && user.password === password
            );
            if (foundUser) {
            const { userId, name, email } = foundUser; // Destructure user properties
            console.log("login");
            const user = {
                userId: userId,
                name: name,
                email: email,
            };
            localStorage.setItem("user", JSON.stringify(user));
            checkUserInLocalStorage();
            $("#login_modal").modal("hide");
            } else {
            console.log("cant login");
            $("#loginError").text("Email or password not found");
            }
        }
          function signupUser(username, email, password){
            const existingUser = users.find(user=> user.email === email);
            if(existingUser){
              $('#signupError').text('Email already exists. Please use a different email');
              return;
            }
            const newUser = {
              userId: users.length + 1,
              name: username,
              email: email,
              password: password,
            }
            const newLocalUser = {
              userId: users.length + 1,
              name: username,
              email: email,
            }
            console.log(newUser)
            users.push(newUser);
            axios.put(userApiUrl, users).then((res)=>{
              console.log(res.data)
            }).catch((err)=>{
              console.log(err)
            })
            
            localStorage.setItem('user', JSON.stringify(newLocalUser));
            $("#signupError").text("");
            checkUserInLocalStorage()
            $("#signup_modal").modal("hide");
          }

          $(document).ready(function() {
              checkUserInLocalStorage();
              $(document).on('click', '#logoutBtn', function() {
                localStorage.removeItem('user');
                location.reload()
              });
              $('#login_modal form').submit(function(e){
                e.preventDefault();
                const email = $('#loginEmail').val();
                const password = $('#loginPassword').val();
                loginUser(email, password)
              })
              $('#signup_modal form').submit(function(e){
                e.preventDefault();
                const username = $('#signupUsername').val()
                const email = $('#signupEmail').val();
                const password = $('#signupPassword').val();
                console.log('signup')
                signupUser(username, email, password);
              })
               $(document).on("click", "#login-btn", function () {
                $("#signup_modal").modal("hide");
                $("#login_modal").modal("show");
            });
            $(document).on("click", "#signup-btn", function () {
                $("#signup_modal").modal("show");
                $("#login_modal").modal("hide");
            });
          });

      
          $(() => {
            //handle the search button
            $("#search-place").click(function(event) {
              event.preventDefault();
              var placeDisplay = [];
              var selectedPlace = $("#places").val();
              //console.log(selectedPlace);
              if (selectedPlace === "") {
                  location.href = "popularplaces.html"
              }
              $.each(places, function(index, value) {
                  if (value.place === selectedPlace) {
                      placeDisplay.push(value);
                      return false; // Stop searching after finding the first match
                  }
              });
              console.log(placeDisplay);
              $("#destinations-container").empty();
              displayCards(placeDisplay);
              displayPageBasedPagination(placeDisplay);
          });
           
            //Delete the pet and put the pets data structure to the jsonBlob array.
            $(document).on("click", ".btn-danger", function () {
              let parentDiv = $(this).parent().parent().parent();
              let parentId = parentDiv.attr("id");
              const index = cities.findIndex((City) => City.cityId === parentId);
              console.log(index);
              if (index !== -1) {
                cities.splice(index, 1);
                console.log(cities);
                $.ajax({
                        type: "PUT",
                        url: "https://jsonblob.com/api/1213499724727705600",
                        data: JSON.stringify(details),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                      success: function(xhr,data,response){
                            console.log(xhr);
                            console.log(data);
                            console.log(response);
                            console.log(response.getAllResponseHeaders());
                        },
                        error: function(errMsg) {
                            alert(errMsg);
                        }
                      });
                $("#destinations-container").empty();
                displayCards(details);
                displayPageBasedPagination(details);
              }
            });
            //populate pet information as default value on update modal
            $(document).on("click", "#btn-edit", function () {
              editCityIdText = $(this)
                .parents()
                .parents()
                .eq(1)
                .find("div")
                .find("ul")
                .find("li[id]")
                .text();
              editingCityId = editCityIdText.split(" ")[1];
              const editingCity = getCitiesById(editingCityId);
              populateUpdateModal(editingCity);
            });

            //update pet information when the edit form is submitted
            $(document).on("click", "#edit-submit", function () {
              const editingCity = getCitiesById(editingCityId);
              var updatedCity = {
                id: editingCity.id,
                avatar: editingCity.avatar,
                name: $("#inputName").val() || editingCity.name,
                destinations: $("#inputDestination").val() || editingCity.destinations,
                best_time_to_visit: $("#inputVisit").val() || editingCity.best_time_to_visit,
                ratings: $("#inputRating").val() || editingCity.ratings,
                high: $("#HighTemperatureAdd").val() || editingCity.high,
                low: $("#LowTemperatureAdd").val() || editingCity.low,
                description: $("#inputDescription").val() || editingCity.description,
              };
              //update UI depend on new pets array stored in jsonBlob
              const index = cities.findIndex((City) => City.cityId === editingCityId);
              if (index !== -1) {
                cities[index] = updatedCity;
              $("#destinations-container").empty();
              displayCards(details);
              }
              $("#update_modal").modal("hide");
              $.ajax({
                        type: "PUT",
                        url: "https://jsonblob.com/api/1213499724727705600",
                        data: JSON.stringify(details),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                      success: function(xhr,data,response){
                            console.log(xhr);
                            console.log(data);
                            console.log(response);
                            console.log(response.getAllResponseHeaders());
                        },
                        error: function(errMsg) {
                            alert(errMsg);
                        }
                      });
            });

            //This is the section where add pet button is handled.
            //upload the image file from the user and add it to the jsonBlob.
            $('#CityImageAdd').change(function(e){
              const file = e.target.files[0];
              const reader = new FileReader();
              reader.onload = function(){
                imageDataUrl = reader.result;
              };
              reader.readAsDataURL(file);
              const filePath= $("#petImageAdd").val().substring(12);
              imageFile = `${"../assets/"}${filePath}`;
              console.log(imageFile);
            })
             function generatePlaceId() {
                return new Date().getTime();
              }
            //When add pet button is clicked we add the new card to the destinations-container.
            $(document).on("click", "#add-submit", function () {
              var addingPlace = {
                placeId: generatePlaceId(),
                avatar: imageFile,
                place: $("#inputNameAdd").val(),
                destinations: $("#inputDestinationAdd").val(),
                best_time_to_visit: $("#inputVisitAdd").val(),
                ratings: $("#inputRatingAdd").val(),
                high: $("#HighTemperatureAdd").val(),
                low: $("#LowTemperatureAdd").val(),
                description: $("#inputDescriptionAdd").val(),
                comments: []
              };
              console.log(addingPlace)
              //update UI depend on new pets array stored in local storage
              //Using unshift method to add the new pet in index 0.
              console.log(places)
              places.unshift(addingPlace);

              const countryIdx = countries.findIndex((Country)=> Country.country === country)
              const cityIdx = cities.findIndex((City)=> City.city === city)
              console.log(countryIdx)
              console.log(cityIdx)
              if(countryIdx !== -1 && cityIdx !== -1){
                 countries[countryIdx].cities[cityIdx].places = places;     
                console.log(countries)
                $("#destinations-container").empty();
                displayCards(places);
                displayPageBasedPagination(places);
                $("#add_modal").modal("hide");
                $.ajax({
                            type: "PUT",
                            url: "https://jsonblob.com/api/1213499724727705600",
                            data: JSON.stringify(countries),
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                        success: function(xhr,data,response){
                                // console.log(xhr);
                                // console.log(data);
                                // console.log(response);
                                // console.log(response.getAllResponseHeaders());
                            },
                            error: function(errMsg) {
                                alert(errMsg);
                            }
                        });
                    
                    }
              
            });
          });
  ;

</script>
  </body>
</html>
